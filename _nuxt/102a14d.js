(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{587:function(e,t,r){"use strict";r.r(t);var n,o=r(9),l=(r(47),r(1)),c=r(411),d=r.n(c),m=r(189),h=r(92);!function(e){e.signIn="signIn",e.signUp="signUp",e.resetPass="resetPass"}(n||(n={}));var f=l.a.extend({meta:{requiresAuth:!1},data:function(){return{state:n.signIn,valid:!0,emailField:"",passwordField:"",usernameField:"",usernameRules:[function(e){return!!e||"Username is required"},function(e){return e&&e.length<=24||"Username must be less than 24 characters"},function(e){return e&&e.length>=3||"Username must be at least 3 characters"},function(e){return d.a.isAlphanumeric(e)||"Username must be alphanumeric"}],isBusy:!1,errorMessage:"",successMessage:""}},head:function(){return{title:"Login",meta:[{name:"Login",content:"Ilyssa Hosting login page"}]}},computed:{bigButtonText:function(){return this.state===n.signIn?"Sign In":this.state===n.signUp?"Sign Up":"Reset Password"},smallButtonText:function(){return this.state===n.signIn?"Sign Up":this.state===n.signUp?"Sign In":"Back"},emailRules:function(){return this.state===n.signIn?[]:[function(e){return!!e||"E-mail is required"},function(e){return d.a.isEmail(e)||"E-mail must be valid"}]},passwordRules:function(){return this.state===n.signIn?[]:[function(e){return!!e||"Password is required"},function(e){return e&&e.length<=40||"Password must be less than 40 characters"},function(e){return e&&e.length>=6||"Password must be at least 6 characters"},function(e){return e===d.a.escape(e)||"<, >, &, ', \" and / are not allowed"}]}},methods:{onSubmit:function(){this.successMessage="",this.errorMessage="",this.isBusy=!0,this.state===n.signIn?this.signIn():this.state===n.signUp?this.signUp():this.resetPassword()},signUp:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$fire.functions.httpsCallable(h.d.checkUsername)({username:e.usernameField});case 3:if(t.sent.data){t.next=8;break}return e.isBusy=!1,e.errorMessage="This username is already taken.",t.abrupt("return");case 8:t.next=13;break;case 10:t.prev=10,t.t0=t.catch(0),e.isBusy=!1;case 13:e.$fire.auth.createUserWithEmailAndPassword(e.emailField,e.passwordField).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(window.localStorage.setItem(m.a.localStorageKeys.username,e.usernameField),t.prev=1,!(n=r.user)){t.next=8;break}return t.next=6,n.updateProfile({displayName:e.usernameField});case 6:return t.next=8,n.sendEmailVerification(h.b);case 8:return t.next=10,e.$fire.functions.httpsCallable(h.d.createNewUser)({username:e.usernameField,email:e.emailField,password:e.passwordField});case 10:e.isBusy=!1,e.$router.push({path:"/verification"}),t.next=17;break;case 14:t.prev=14,t.t0=t.catch(1),e.isBusy=!1;case 17:case"end":return t.stop()}}),t,null,[[1,14]])})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var r=t.code;"auth/email-already-in-use"===r?e.errorMessage="This email is already in use.":"auth/weak-password"===r&&(e.errorMessage="The password is too weak."),e.isBusy=!1}));case 14:case"end":return t.stop()}}),t,null,[[0,10]])})))()},signIn:function(){var e=this;this.$fire.auth.signInWithEmailAndPassword(this.emailField,this.passwordField).then(function(){var t=Object(o.a)(regeneratorRuntime.mark((function t(r){var n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.user){t.next=3;break}return t.abrupt("return");case 3:if(n.emailVerified){t.next=9;break}return t.next=6,n.sendEmailVerification(h.b);case 6:return e.isBusy=!1,e.$router.push({path:"/verification"}),t.abrupt("return");case 9:e.isBusy=!1,e.$router.push({path:"/dashboard"});case 11:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(t){var code=t.code;"auth/wrong-password"===code?e.errorMessage="Your password was incorrect.":"auth/user-not-found"===code?e.errorMessage="Your email was incorrect.":"auth/invalid-email"===code&&(e.errorMessage="This email address is invalid."),e.isBusy=!1}))},resetPassword:function(){var e=this;return Object(o.a)(regeneratorRuntime.mark((function t(){var code;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$fire.auth.sendPasswordResetEmail(e.emailField);case 3:e.successMessage="An email has been sent for password reset.",t.next=10;break;case 6:t.prev=6,t.t0=t.catch(0),"auth/user-not-found"===(code=t.t0.code)?e.errorMessage="Your email was incorrect.":"auth/invalid-email"===code&&(e.errorMessage="This email address is invalid.");case 10:e.isBusy=!1;case 11:case"end":return t.stop()}}),t,null,[[0,6]])})))()},changeState:function(){this.errorMessage="",this.successMessage="",this.state===n.signIn?this.state=n.signUp:this.state=n.signIn},toResetPassword:function(){this.state=n.resetPass}}}),v=r(59),x=r(60),w=r.n(x),y=r(250),_=r(413),k=r(414),F=r(582),B=r(176),U=r(149),I=r(415),component=Object(v.a)(f,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"d-flex flex-column fill-height justify-center align-center"},[r("v-card",{staticClass:"pa-6",attrs:{color:"accent","max-width":"400",width:"95%"}},[r("div",{staticClass:"d-flex px-2 pb-5 flex-grow-1 justify-center align-center"},[r("v-img",{attrs:{alt:"logo",src:"/assets/logo.svg",contain:"",width:"auto",height:"40"}})],1),e._v(" "),r("v-divider",{staticClass:"mb-2"}),e._v(" "),r("v-form",{ref:"form",staticClass:"px-2 py-4",model:{value:e.valid,callback:function(t){e.valid=t},expression:"valid"}},[e.errorMessage?r("div",{staticClass:"mb-6 text-center"},[r("v-icon",{attrs:{color:"error"}},[e._v("\n          mdi-alert-circle-outline\n        ")]),e._v(" "),r("span",{staticClass:"text-center text-body-2 error--text text--darken-1"},[e._v("\n          "+e._s(e.errorMessage)+"\n        ")])],1):e._e(),e._v(" "),e.successMessage?r("div",{staticClass:"mb-6 text-center"},[r("v-icon",{attrs:{color:"success"}},[e._v("\n          mdi-check-circle-outline\n        ")]),e._v(" "),r("span",{staticClass:"text-center text-body-2 success--text text--darken-1"},[e._v("\n          "+e._s(e.successMessage)+"\n        ")])],1):e._e(),e._v(" "),"signUp"===e.state?r("v-text-field",{attrs:{rules:e.usernameRules,label:"Username",color:"primary",disabled:e.isBusy,outlined:""},model:{value:e.usernameField,callback:function(t){e.usernameField=t},expression:"usernameField"}}):e._e(),e._v(" "),r("v-text-field",{attrs:{rules:e.emailRules,label:"Email",color:"primary",disabled:e.isBusy,outlined:"",type:"email"},model:{value:e.emailField,callback:function(t){e.emailField=t},expression:"emailField"}}),e._v(" "),"resetPass"!==e.state?r("v-text-field",{attrs:{rules:e.passwordRules,label:"Password",color:"primary",disabled:e.isBusy,outlined:"",type:"password"},model:{value:e.passwordField,callback:function(t){e.passwordField=t},expression:"passwordField"}}):e._e(),e._v(" "),r("div",{staticClass:"d-flex flex-column text-center"},["signUp"===e.state?r("span",{staticClass:"mb-2 text-center text-body-2 grey--text text--darken-1"},[e._v("\n          Note: Username cannot be changed later\n        ")]):e._e(),e._v(" "),r("v-btn",{staticClass:"pa-6 text-none text-body-1 accent--text font-weight-bold",attrs:{loading:e.isBusy,color:"primary","min-width":"140",block:"",disabled:!e.valid},on:{click:e.onSubmit}},[e._v("\n          "+e._s(e.bigButtonText)+"\n        ")])],1)],1),e._v(" "),r("div",{staticClass:"d-flex flex-column text-center"},[r("v-btn",{staticClass:"ma-2 pa-4 text-none text-body-2 font-weight-light",attrs:{color:"primary",text:"",small:"",disabled:e.isBusy},on:{click:e.changeState}},[e._v("\n        "+e._s(e.smallButtonText)+"\n      ")]),e._v(" "),"signIn"===e.state?r("v-btn",{staticClass:"ma-2 mt-0 pa-4 text-none text-body-2 font-weight-light",attrs:{color:"primary",text:"",small:"",disabled:e.isBusy},on:{click:e.toResetPassword}},[e._v("\n        Forgot your password?\n      ")]):e._e()],1)],1)],1)}),[],!1,null,null,null);t.default=component.exports;w()(component,{VBtn:y.a,VCard:_.a,VDivider:k.a,VForm:F.a,VIcon:B.a,VImg:U.a,VTextField:I.a})}}]);